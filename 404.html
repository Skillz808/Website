<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/xp.css">
    <link rel="shortcut icon" href="./img/xpicon.png" type="image/x-icon">
    <link rel="stylesheet" href="./notFound.css">
    <title>404: Not Found</title>
</head>
<body>
    <audio id="closeSound" src="./img/ding.mp3" style="display: none;"></audio>

    <script>
        function getRandomCoordinates() {
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;

            const randomLeft = Math.floor(Math.random() * (screenWidth - 400)); // Subtracting 400 to keep it within the screen width
            const randomTop = Math.floor(Math.random() * (screenHeight - 100)); // Subtracting 100 to keep it within the screen height

            return { left: randomLeft + "px", top: randomTop + "px" };
        }

        function getRandomSize() {
            const minWidth = 100; // Minimum width
            const maxWidth = 300; // Maximum width
            const minHeight = 100; // Minimum height
            const maxHeight = 300; // Maximum height

            const randomWidth = Math.floor(Math.random() * (maxWidth - minWidth + 1)) + minWidth;
            const randomHeight = Math.floor(Math.random() * (maxHeight - minHeight + 1)) + minHeight;

            return { width: randomWidth + "px", height: randomHeight + "px" };
        }

        const dogBoxTitles = ["A Dog", "Also A Dog", "Behold: A Dog", "What's this? A Dog?", "arfff"];

        function getRandomTitle() {
          // Generate a random index within the array length
          const randomIndex = Math.floor(Math.random() * dogBoxTitles.length);
    
          // Return the randomly selected title
          return dogBoxTitles[randomIndex];
        }

        function createRandomDogBox() {
            const randomCoordinates = getRandomCoordinates();
            const randomSize = getRandomSize();

            const dogBox = document.createElement("div");
            dogBox.className = "window";
            dogBox.style.position = "absolute";
            dogBox.style.left = randomCoordinates.left;
            dogBox.style.top = randomCoordinates.top;

            // Title Bar
            const titleBar = document.createElement("div");
            titleBar.className = "title-bar";
            titleBar.innerHTML = `
                <div class="title-bar-text">${getRandomTitle()}</div>
                <div class="title-bar-controls">
                    <button aria-label="Close" onclick="removeDogBox(this.parentNode.parentNode);"></button>
                </div>
            `;

            // Window Body
            const windowBody = document.createElement("div");
            windowBody.className = "window-body";
            windowBody.style.width = randomSize.width;
            windowBody.style.height = randomSize.height;

            const img = document.createElement("img");
            img.src = "./img/undertale-annoying.gif";
            img.style.width = "100%";
            img.style.height = "100%";

            windowBody.appendChild(img);

            // Append Title Bar and Window Body to Dog Box
            dogBox.appendChild(titleBar);
            dogBox.appendChild(windowBody);

            // Make the Dog Box draggable
            makeElementDraggable(dogBox);

            // Append Dog Box to Body
            document.body.appendChild(dogBox);
        }

        function makeElementDraggable(element) {
            var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            const titleBar = element.querySelector(".title-bar");

            titleBar.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // get the mouse cursor position at startup:
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                // call a function whenever the cursor moves:
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                // calculate the new cursor position:
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                // set the element's new position:
                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                // stop moving when mouse button is released:
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        const closeSound = new Audio("./img/dingloudish.mp3");
        closeSound.preload = "auto";

        function removeDogBox(dogBox) {
        // Ensure that dogBox exists and has a parent node before attempting to remove it
        if (dogBox && dogBox.parentNode) {
            // Play the preloaded audio
            closeSound.play();
        }
        }

        // Call createRandomDogBox every 2 seconds (adjust the interval as needed)
        setInterval(createRandomDogBox, 1000);
    </script>

    <div class="window" style="width: 315px; z-index: 2;" id="musicplayer">
        <div class="title-bar" id="musicplayerheader">
            <div class="title-bar-text">404... <span style="opacity: 0;">pet it</span></div>
            <div class="title-bar-controls">
                <button aria-label="Close" onclick="removeMusicPlayer(); "></button>
            </div>
        </div>
        <div class="window-body">
            <audio id="audioplayer" controls="controls" src="" autoplay loop></audio>
        </div>
    </div>

    <script type="text/javascript" src="notFound.js"></script>
</body>
</html>